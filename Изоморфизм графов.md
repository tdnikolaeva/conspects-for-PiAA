# Изоморфизм графов

Графы G1(V1, E1), G2(V2, E2) называются изоморфными, если между ними существует взаимно однозначное отображение phi: G1->G2 (V1->V2, E1->E2), которое сохраняет соответствие между ребрами графов, т.е. для любого ребра e=(v,u) верно e'=phi(e)=(phi(u), phi(v)).



## Применение
Это используется:
* в химии

  * разработка новых нуклеарных соединений
  * определение является ли рассматриваемая молекула какой-то из известных (та или не та)
  * поиск в графе изоморфных подграфов
    
* еще всякие SLAM-алгоритмы
    * для всяких дронов - они не всегда через GPS могут местоположение определять, а так они сравнивают с картой то, что под ними находится)
* генетические алгоритмы
    * для поиска геномов в геноме
* социальные сети и рекомендательные системы
    * Анализ изоморфных графов может быть полезным для исследования социальных сетей, выявления общих паттернов и структурных связей между участниками сети. Кроме того, изоморфные графы могут быть использованы для рекомендации контента или товаров на основе
схожих интересов и предпочтений.
    




## Алгоритм Ульмана
Алгоритм основан на методе перебора с использованием матрицы соответствия. 
* Матрица соответствия - это матрица, где строки соотвествуют вершинам G1, а столбцы - вершинам G2. 
* a[i][j] = 1, если потенциально считаем, что вершина i G1 изоморфна j вершине G2.
* a[i][j] = 0, если точно i не будет переведена в j.


Цель алгоритма - пытаемся проанализировать текущую матрицу, убрав 1. Если не можем 1 убрать, считаем, что нашли изоморфный граф. Мы смотрим смежные вершины в G1. Где-то должна быть 1. Убираем вершины, соседи которых гарантированно не изоморфны. Анализ матрицы с бектрекингом по поиску в глубину.



Алгоритм состоит из 2 шагов:
1. Предварительная обработка
    1. Создается матрица MxN, где M=|V1|, N=|V2|. Изначально все ячейки матрицы установлены на значение 0 - false
    2. Для каждой пары вершин (u, v) //u из G1, v из G2// проверяется их изоморфность
        * Если u, v имеют одинаковую степень и нет других вершин, которые уже были сопоставлены с u и v, то устанавливается значение 1 - true в соответсвующей ячейке матрицы.
    3. Повторяется предыдущий шаг до тех пор, пока нельзя больше установить новые соответствия
2. Рекурсивный поиск
    1. Для каждой пары вершин (u, v), для которых значение 1 - true установлено в матрице соответствия
        * Помечаем вершины u, v как сопоставленные
        * Рекурсивно продолжаем поиск со следующей пары вершин
        * Если поиск успешен для всех пар вершин, то графы считаются изоморфными
        * Если поиск неуспешен, отменяем сопоставление вершин u, v и продолжаем с другой парой вершин
    
Алгоритм Ульмана может быть реализован с использованием рекурсии и обратного отслеживания, чтобы определить все возможные изоморфные соответствия между вершинами двух графов.
Важно отметить, что алгоритм Ульмана имеет **экспоненциальную сложность в худшем случае**,
поэтому он может столкнуться с проблемами при работе с большими графами. Однако, на практике
он может быть эффективен для небольших графов или при оптимизациях, таких как использование
эвристик и проверка дополнительных условий для исключения некоторых неправильных сопоставлений

